[Test]
DisableChecks = true

[Grid]
BinaryMask = ATA_Sample1_crop_small.raw
Cells = 100 100 100
#PixelDimensions = 1e-5 1e-5 1e-5
PixelDimensions = 1 1 1
KeepOnlyConnected = X
RegionFile = ATA_Sample1_crop_small_segmentation_regions.txt

[PNM.Grid]
File = ATA_Sample1_crop_small.dgf
PoreGeometry = Sphere
ThroatCrossSectionShape = Square

[Problem]
Name = test_stokes_upscaling
EnableGravity = false
EnableInertiaTerms = false
PressureGradient = 1
UsePNMInitialPressure = false
#SideLength = 1e-3 1e-3 1e-3
ArtificialCompressibility = 0.03
CFL = 0.1

[FreeFlow]
EnableUnsymmetrizedVelocityGradient = false

[Component]
# this test requires a unit fluid
LiquidDensity = 1
LiquidKinematicViscosity = 1

[Assembly.NumericDifference]
PriVarMagnitude = 1
BaseEpsilon = 1

[LinearSolver]
Verbosity = 2
MaxIterations = 1000
ResidualReduction = 1e-8
UseDirectSolver = false
UseUzawa = false
GMResRestart = 100
#PrintMatrix = true

[LinearSolver.Preconditioner]
DetermineRelaxationFactor = false
Relaxation = 1e15
IterativeSolverForA = amg
Verbosity = 2
UseDirectVelocitySolver = false
UseBlockTriangular = true
UseFullSchurComplement = false
Iterations = 3
AmgSmootherIterations = 1
AmgCriterionSymmetric = true
AmgMaxLevel = 100
AmgDefaultAggregationDimension = 3
AmgMinAggregateSize = 3
AmgMaxAggregateSize = 3
TwoLevelIterations = 0

[Newton]
MinSteps = 1
EnableAbsoluteResidualCriterion = true
MaxAbsoluteResidual = 1e-5

[Vtk]
WriteFaceData = false
OutputInterval = 10

[FluxOverPlane]
Verbose = true
