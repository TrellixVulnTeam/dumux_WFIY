This model implements two-phase flow of two completely immiscible fluids $\alpha \in \{ w, n \}$ using a standard multiphase Darcy approach as the equation for the conservation of momentum: \[ \vec{v_\alpha} = - \frac{k_{r\alpha}}{\mu_\alpha} K \left(\grad p_\alpha - \varrho_{\alpha} \boldsymbol{g} \right) \]

By inserting this into the equation for the conservation of the phase mass, one gets \[ \phi \frac{\partial \varrho_\alpha S_\alpha}{\partial t} - \Div \left\{ \varrho_\alpha \frac{k_{r\alpha}}{\mu_\alpha} K \left(\grad p_\alpha - \varrho_{\alpha} \boldsymbol{g} \right) \right\} = q_\alpha \;, \] which is discretized by this model using the fully-coupled vertex centered finite volume (box) scheme as spatial and the implicit Euler method as time discretization.

By using constitutive relations for the capillary pressure $p_c = p_n - p_w$ and relative permability $k_{r\alpha}$ and taking advantage of the fact that $S_w + S_n = 1$, the number of unknowns can be reduced to two. Currently the model supports chosing either $p_w$ and $S_n$ or $p_n$ and $S_w$ as primary variables. The formulation which ought to be used can be specified by setting the {\tt Formulation} property to either either {\tt \doxyref{TwoPIndices::pWsN}{p.}{structDune_1_1TwoPIndices_7bab78f10df58319eafe8b79a1d28553}} or {\tt \doxyref{TwoPIndices::pNsW}{p.}{structDune_1_1TwoPIndices_b2b28761c782605cf080f9b6f9b618b5}}. By default, the model uses $p_w$ and $S_n$. 
